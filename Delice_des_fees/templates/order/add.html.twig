{% extends 'base.html.twig' %}

{% block title %}Valider les commandes{% endblock %}

<div class="message"><h1> {{message}} </h1></div>
{% block body %}


    <h1>Mon récap</h1>
<hr>
                Vérifiez vos informations avant de payer votre commande
<hr><br>


<div class="row">

<div class="col-md-6">
<strong>Mon adresse de livraison</strong> <br>
{{delivery|raw}}
<hr>
<strong>Mon transporteur </strong> <br>

{{carrier.name}}<br>
{{carrier.description}}<br>
{{carrier.price|number_format(2, ',','.')}} €<br>
</div>

<div class="col-md-6">
<div class="text-center">
    Ma commande <hr>
    </div>
 {% set total = null %}
{% for product in cart %}

<table class="table ">
  <tbody>
    <tr>
      <th scope="row"><img src="/upload/{{ product.product.illustration}}" alt ="{{ product.product.name }}" height="75px"></th>
      <td>  {{product.product.name}}</td>
      <td>x {{product.quantity}}</td>
      <td>{{ ((product.product.prix) * product.quantity)|number_format(2) }} €</td>
    </tr>
  </tbody>
</table>
{% set total = total + (product.product.prix * product.quantity) %}
    {% endfor %}
    <strong>Sous total :</strong> {{ (total)|number_format(2, ',','.') }} € <br>
    <strong>Livraison :</strong> {{ (carrier.price)|number_format(2, ',','.') }} €
    <hr>
    <strong>Total :</strong> {{ (total + carrier.price)|number_format(2, ',','.') }}  € <br><br><hr>


<a href="{{ path('stripe_create_session', {'reference': reference}) }}" class="btn btn-success" id="checkout-button">Payer {{ (total + carrier.price)|number_format(2, ',','.') }} € </a>
</div>



</div>


{% endblock %}



{% block script %}

{% endblock %}
